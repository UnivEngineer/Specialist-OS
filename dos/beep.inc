;+---------------------------------------------------------------------------
; MXOS
; Звуковой сигнал (вызывается при выводе кода 7)
;
; Все регистры сохраняются
;
; 2013-12-12 Дизассемблировано vinxru
;----------------------------------------------------------------------------

beep:       ; Сохраняем все регистры. de не используется ниже
            push  af
            push  bc
            push  hl

            ; Частота и длительность сигнала
            ld    hl, (bios_vars.beepDuration)

beep_0:     ; Единицу на динамик
            ld    a, 0Bh
            ld    (IO_KEYB_MODE),a

            ; Задержка l тактов
            call  delay_l

            ; Ноль на динамик
            ld    a, 0Ah
            ld    (IO_KEYB_MODE),a

            ; Задержка l тактов
            call  delay_l

            ; Повторяем h раз
            dec   h
            jp nz,  beep_0

            ; Ничего не делаем
            nop

            ; Восстаналиваем все регистры и выходим. de не используется
            pop   hl
            pop   bc
            pop   af
            ret

