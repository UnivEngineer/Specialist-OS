;+---------------------------------------------------------------------------
; MXOS
; Обработка служебных кодов при выводе символа (продолжение)
; Расчет адреса символа в знакогенераторе и адреса вывода на экран
;
; 2013-12-12 Дизассемблировано vinxru
;----------------------------------------------------------------------------

; ---------------------------------------------------------------------------
; Обработка ESC+(. Включение KOI-7

printChar_e28:
            ld    a, 0FFh
            ld    (bios_vars.koi7), a
            ret

; ---------------------------------------------------------------------------
; Обработка ESC+). Включение KOI-8

printChar_e29:
            xor   a
            ld    (bios_vars.koi7), a
            ret

; ---------------------------------------------------------------------------
; Обработка кода 9. Табуляция

printChar_c9:
            ld    a, (bios_vars.cursorX)  
            add   a, 12 ; 24
            ld    (bios_vars.cursorX),a
            ret

; ---------------------------------------------------------------------------
; Вывод символа С из знакогенартора по адресу hl*8 на экран в положение 
; курсора. Курсор при этом перемещается 

printChar_alt:
            ; de = (hl+c) * 8
            ld    b, 0
            add   hl, bc
            add   hl, hl
            add   hl, hl
            add   hl, hl
            ex    de, hl

            ; Продолжение в printChar_de

; ---------------------------------------------------------------------------
; Вывод символа de на экран в положение курсора. Курсор при этом перемещается 
; вправо.

printChar_de:
            ; Рассчитываем адрес вывода (hl=v_cursorPos, a*256+l=адрес)
            call  calcCursorAddr

            ; Перемещаем курсор вправо
            inc   h
            inc   h
            inc   h           
            ld    (bios_vars.cursorY), hl

            ; Корректируем адрес вывода (bc = al - 7)
            ld    b, a
            ld    a, l
            sub   7
            ld    c, a

            ; Продолжение в drawChar

