;+---------------------------------------------------------------------------
; MXOS
; Загрузка шрифта в память
;
; Разработано vinxru
; Доработано SpaceEngineer
;----------------------------------------------------------------------------

initFont:   ; Изменяем команду перехода сюда на reboot2
            ld      hl, reboot2
            ld      (onceInitFont+1), hl
            push    hl

    IF EMBED_FONT == 0

            ; Шрифт грузится из файла
            ; Устанавливаем блочный драйвер ДОЗУ
            ld      b, 0
            call    setRAMDDriver

            ; Ищем и загружаем файл A:FONT.FNT на адрес FONT_ADDR
            ld      hl, pathFontFnt
            ld      de, v_curFileDescr
            call    fileNamePrepare   ; подготовка имени файла и переключение накопителя
            ex      de, hl
            ld      de, FONT_ADDR
            jp      fileLoad2

    ELSE
            ; Шрифт встроен в хвост программы
            ; Копируем его на адрес FONT_ADDR
            ld      hl, font
            ld      de, fontEnd
            ld      bc, FONT_ADDR
            jp      memcpy_bc_hl

font:
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 0
      DB 004h,00Eh,015h,004h,015h,00Eh,004h,000h ; 1
      DB 000h,000h,004h,00Ah,01Fh,000h,01Fh,000h ; 2
      DB 000h,000h,01Fh,00Ah,004h,000h,01Fh,000h ; 3
      DB 009h,01Bh,02Dh,01Bh,009h,000h,000h,000h ; 4
      DB 024h,036h,02Dh,036h,024h,000h,000h,000h ; 5
      DB 01Eh,021h,02Dh,029h,02Dh,021h,01Eh,000h ; 6
      DB 010h,018h,017h,015h,017h,018h,010h,000h ; 7
      DB 000h,000h,004h,008h,01Fh,008h,004h,000h ; 8
      DB 000h,000h,014h,012h,01Fh,012h,014h,000h ; 9
      DB 013h,012h,013h,01Ah,000h,01Fh,000h,000h ; 10
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 11
      DB 01Ch,018h,014h,002h,001h,001h,001h,000h ; 12
      DB 01Fh,001h,001h,005h,009h,01Fh,008h,004h ; 13
      DB 003h,004h,004h,01Ch,03Ch,018h,000h,000h ; 14
      DB 003h,009h,005h,03Fh,005h,009h,003h,000h ; 15
      DB 003h,009h,011h,03Fh,011h,009h,003h,000h ; 16
      DB 004h,00Ah,011h,00Ah,004h,000h,000h,000h ; 17
      DB 011h,011h,011h,011h,011h,000h,011h,000h ; 18
      DB 000h,000h,000h,000h,000h,011h,011h,000h ; 19
      DB 000h,008h,000h,008h,000h,008h,000h,000h ; 20
      DB 004h,004h,000h,01Fh,000h,004h,004h,000h ; 21
      DB 00Fh,008h,008h,008h,008h,028h,010h,000h ; 22
      DB 03Fh,000h,000h,000h,000h,000h,000h,000h ; 23
      DB 000h,000h,004h,002h,01Fh,002h,004h,000h ; 24
      DB 004h,00Eh,015h,004h,004h,004h,004h,000h ; 25
      DB 004h,004h,004h,004h,015h,00Eh,004h,000h ; 26
      DB 01Bh,012h,01Ah,012h,01Bh,000h,01Fh,000h ; 27
      DB 03Fh,001h,000h,000h,000h,000h,000h,000h ; 28
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 29
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 30
      DB 01Fh,011h,019h,015h,013h,011h,01Fh,000h ; 31
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 32
      DB 004h,004h,004h,004h,004h,000h,004h,000h ; 33
      DB 00Ah,00Ah,00Ah,000h,000h,000h,000h,000h ; 34
      DB 00Ah,00Ah,01Fh,00Ah,01Fh,00Ah,00Ah,000h ; 35
      DB 004h,00Fh,014h,00Eh,005h,01Eh,004h,000h ; 36
      DB 010h,011h,002h,004h,008h,011h,001h,000h ; 37
      DB 004h,00Ah,00Ah,00Ch,015h,012h,00Dh,000h ; 38
      DB 000h,002h,002h,004h,000h,000h,000h,000h ; 39
      DB 002h,004h,008h,008h,008h,004h,002h,000h ; 40
      DB 008h,004h,002h,002h,002h,004h,008h,000h ; 41
      DB 000h,004h,015h,00Eh,015h,004h,000h,000h ; 42
      DB 000h,004h,004h,01Fh,004h,004h,000h,000h ; 43
      DB 000h,000h,000h,000h,000h,004h,004h,008h ; 44
      DB 000h,000h,000h,01Fh,000h,000h,000h,000h ; 45
      DB 000h,000h,000h,000h,000h,004h,004h,000h ; 46
      DB 000h,001h,002h,004h,008h,010h,000h,000h ; 47
      DB 00Eh,011h,013h,015h,019h,011h,00Eh,000h ; 48
      DB 004h,00Ch,004h,004h,004h,004h,00Eh,000h ; 49
      DB 00Eh,011h,001h,006h,008h,010h,01Fh,000h ; 50
      DB 01Fh,001h,002h,006h,001h,011h,00Eh,000h ; 51
      DB 002h,006h,00Ah,012h,01Fh,002h,002h,000h ; 52
      DB 01Fh,010h,01Eh,001h,001h,011h,00Eh,000h ; 53
      DB 007h,008h,010h,01Eh,011h,011h,00Eh,000h ; 54
      DB 01Fh,001h,002h,004h,008h,008h,008h,000h ; 55
      DB 00Eh,011h,011h,00Eh,011h,011h,00Eh,000h ; 56
      DB 00Eh,011h,011h,00Fh,001h,002h,01Ch,000h ; 57
      DB 000h,004h,004h,000h,000h,004h,004h,000h ; 58
      DB 000h,004h,004h,000h,000h,004h,004h,008h ; 59
      DB 002h,004h,008h,010h,008h,004h,002h,000h ; 60
      DB 000h,000h,01Fh,000h,01Fh,000h,000h,000h ; 61
      DB 008h,004h,002h,001h,002h,004h,008h,000h ; 62
      DB 00Eh,011h,001h,002h,004h,000h,004h,000h ; 63
      DB 00Eh,011h,013h,015h,017h,010h,00Eh,000h ; 64
      DB 004h,00Ah,011h,011h,01Fh,011h,011h,000h ; 65
      DB 01Eh,011h,011h,01Eh,011h,011h,01Eh,000h ; 66
      DB 00Eh,011h,010h,010h,010h,011h,00Eh,000h ; 67
      DB 01Eh,009h,009h,009h,009h,009h,01Eh,000h ; 68
      DB 01Fh,010h,010h,01Eh,010h,010h,01Fh,000h ; 69
      DB 01Fh,010h,010h,01Eh,010h,010h,010h,000h ; 70
      DB 00Eh,011h,010h,010h,013h,011h,00Fh,000h ; 71
      DB 011h,011h,011h,01Fh,011h,011h,011h,000h ; 72
      DB 00Eh,004h,004h,004h,004h,004h,00Eh,000h ; 73
      DB 001h,001h,001h,001h,011h,011h,00Eh,000h ; 74
      DB 011h,012h,014h,018h,014h,012h,011h,000h ; 75
      DB 010h,010h,010h,010h,010h,011h,01Fh,000h ; 76
      DB 011h,01Bh,015h,015h,011h,011h,011h,000h ; 77
      DB 011h,011h,019h,015h,013h,011h,011h,000h ; 78
      DB 00Eh,011h,011h,011h,011h,011h,00Eh,000h ; 79
      DB 01Eh,011h,011h,01Eh,010h,010h,010h,000h ; 80
      DB 00Eh,011h,011h,011h,015h,012h,00Dh,000h ; 81
      DB 01Eh,011h,011h,01Eh,014h,012h,011h,000h ; 82
      DB 00Eh,011h,010h,00Eh,001h,011h,00Eh,000h ; 83
      DB 01Fh,004h,004h,004h,004h,004h,004h,000h ; 84
      DB 011h,011h,011h,011h,011h,011h,00Eh,000h ; 85
      DB 011h,011h,011h,00Ah,00Ah,004h,004h,000h ; 86
      DB 011h,011h,011h,015h,015h,015h,00Ah,000h ; 87
      DB 011h,011h,00Ah,004h,00Ah,011h,011h,000h ; 88
      DB 011h,011h,00Ah,004h,004h,004h,004h,000h ; 89
      DB 01Fh,001h,002h,00Eh,008h,010h,01Fh,000h ; 90
      DB 00Eh,008h,008h,008h,008h,008h,00Eh,000h ; 91
      DB 000h,010h,008h,004h,002h,001h,000h,000h ; 92
      DB 00Eh,002h,002h,002h,002h,002h,00Eh,000h ; 93
      DB 004h,00Ah,011h,000h,000h,000h,000h,000h ; 94
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 95
      DB 000h,00Fh,000h,006h,009h,009h,006h,000h ; 96
      DB 000h,000h,00Ch,002h,00Eh,012h,00Dh,000h ; 97
      DB 008h,008h,008h,00Eh,009h,009h,016h,000h ; 98
      DB 000h,000h,00Eh,011h,010h,011h,00Eh,000h ; 99
      DB 002h,002h,002h,00Eh,012h,012h,00Dh,000h ; 100
      DB 000h,000h,00Eh,011h,01Fh,010h,00Eh,000h ; 101
      DB 006h,009h,008h,01Ch,008h,008h,008h,000h ; 102
      DB 000h,000h,00Dh,012h,012h,00Eh,002h,01Ch ; 103
      DB 010h,010h,010h,01Eh,011h,011h,011h,000h ; 104
      DB 000h,010h,000h,010h,010h,011h,00Eh,000h ; 105
      DB 000h,001h,000h,001h,001h,001h,011h,00Eh ; 106
      DB 010h,010h,011h,012h,01Ch,012h,011h,000h ; 107
      DB 010h,010h,010h,010h,010h,011h,00Eh,000h ; 108
      DB 000h,000h,01Ah,015h,015h,015h,015h,000h ; 109
      DB 000h,000h,016h,019h,011h,011h,011h,000h ; 110
      DB 000h,000h,00Eh,011h,011h,011h,00Eh,000h ; 111
      DB 000h,000h,016h,009h,009h,00Eh,008h,008h ; 112
      DB 000h,000h,00Dh,012h,012h,00Eh,002h,002h ; 113
      DB 000h,000h,016h,009h,008h,008h,008h,000h ; 114
      DB 000h,000h,00Eh,010h,00Eh,001h,00Eh,000h ; 115
      DB 008h,008h,01Ch,008h,008h,009h,006h,000h ; 116
      DB 000h,000h,012h,012h,012h,012h,00Dh,000h ; 117
      DB 000h,000h,011h,011h,011h,00Ah,004h,000h ; 118
      DB 000h,000h,015h,015h,015h,015h,00Ah,000h ; 119
      DB 000h,000h,011h,00Ah,004h,00Ah,011h,000h ; 120
      DB 000h,000h,011h,011h,011h,00Fh,001h,00Eh ; 121
      DB 000h,000h,01Fh,001h,00Eh,010h,01Fh,000h ; 122
      DB 003h,004h,004h,018h,004h,004h,003h,000h ; 123
      DB 01Fh,011h,011h,011h,011h,011h,01Fh,000h ; 124
      DB 018h,004h,004h,003h,004h,004h,018h,000h ; 125
      DB 000h,000h,008h,015h,002h,000h,000h,000h ; 126
      DB 001h,003h,007h,00Fh,007h,003h,001h,000h ; 127
      DB 000h,000h,00Ah,01Fh,01Fh,00Eh,004h,000h ; 128
      DB 000h,004h,004h,01Fh,004h,004h,01Bh,000h ; 129
      DB 004h,00Eh,01Fh,01Fh,00Ah,004h,01Bh,000h ; 130
      DB 000h,000h,004h,00Eh,01Fh,00Eh,004h,000h ; 131
      DB 002h,004h,00Ah,015h,011h,011h,00Eh,000h ; 132
      DB 00Eh,004h,01Fh,015h,004h,00Ah,011h,000h ; 133
      DB 003h,004h,006h,009h,006h,002h,00Ch,000h ; 134
      DB 007h,003h,005h,00Ch,012h,012h,00Ch,000h ; 135
      DB 00Eh,011h,011h,00Eh,004h,00Eh,004h,000h ; 136
      DB 000h,017h,014h,01Fh,005h,01Dh,000h,000h ; 137
      DB 004h,004h,01Fh,004h,014h,00Ch,006h,005h ; 138
      DB 004h,01Fh,004h,00Ah,011h,01Fh,004h,000h ; 139
      DB 004h,01Fh,005h,00Ah,011h,01Fh,004h,000h ; 140
      DB 004h,004h,01Fh,000h,01Fh,004h,004h,000h ; 141
      DB 004h,00Eh,00Ah,00Ah,00Ah,00Eh,004h,000h ; 142
      DB 004h,006h,001h,006h,001h,006h,004h,000h ; 143
      DB 000h,000h,000h,03Fh,03Fh,000h,000h,000h ; 144
      DB 030h,030h,030h,030h,030h,030h,030h,030h ; 145
      DB 003h,003h,003h,003h,003h,003h,003h,003h ; 146
      DB 030h,030h,030h,03Fh,03Fh,030h,030h,030h ; 147
      DB 003h,003h,003h,03Fh,03Fh,003h,003h,003h ; 148
      DB 000h,000h,000h,03Fh,03Fh,030h,030h,030h ; 149
      DB 000h,000h,000h,03Fh,03Fh,003h,003h,003h ; 150
      DB 003h,003h,003h,03Fh,03Fh,000h,000h,000h ; 151
      DB 030h,030h,030h,03Fh,03Fh,000h,000h,000h ; 152
      DB 000h,000h,000h,03Fh,03Fh,018h,018h,018h ; 153
      DB 018h,018h,018h,018h,018h,018h,018h,018h ; 154
      DB 018h,018h,018h,03Fh,03Fh,000h,000h,000h ; 155
      DB 018h,018h,018h,03Fh,03Fh,018h,018h,018h ; 156
      DB 000h,000h,001h,002h,014h,008h,000h,000h ; 157
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 158
      DB 000h,000h,000h,000h,000h,000h,000h,000h ; 159
      DB 002h,002h,00Ah,016h,012h,012h,00Dh,000h ; 160
      DB 006h,009h,00Eh,009h,00Eh,008h,010h,000h ; 161
      DB 01Fh,011h,011h,010h,010h,010h,010h,000h ; 162
      DB 00Fh,010h,012h,00Ah,00Ah,00Ah,011h,000h ; 163
      DB 01Fh,008h,004h,002h,004h,008h,01Fh,000h ; 164
      DB 005h,00Ah,010h,01Eh,011h,011h,00Eh,000h ; 165
      DB 009h,009h,009h,009h,00Fh,009h,010h,000h ; 166
      DB 008h,014h,004h,002h,006h,009h,011h,000h ; 167
      DB 015h,015h,015h,00Eh,004h,004h,004h,000h ; 168
      DB 00Eh,011h,01Bh,01Fh,01Bh,011h,00Eh,000h ; 169
      DB 00Eh,011h,011h,00Eh,004h,015h,01Bh,000h ; 170
      DB 006h,009h,009h,006h,000h,000h,000h,000h ; 171
      DB 00Eh,013h,015h,019h,00Eh,000h,000h,000h ; 172
      DB 002h,006h,002h,002h,007h,000h,000h,000h ; 173
      DB 006h,009h,002h,004h,00Fh,000h,000h,000h ; 174
      DB 00Fh,001h,002h,009h,006h,000h,000h,000h ; 175
      DB 00Ah,00Ah,00Fh,002h,002h,000h,000h,000h ; 176
      DB 00Eh,008h,00Eh,001h,00Eh,000h,000h,000h ; 177
      DB 006h,008h,00Eh,009h,006h,000h,000h,000h ; 178
      DB 00Fh,001h,002h,004h,004h,000h,000h,000h ; 179
      DB 006h,009h,006h,009h,006h,000h,000h,000h ; 180
      DB 006h,009h,007h,001h,006h,000h,000h,000h ; 181
      DB 000h,000h,00Eh,013h,015h,019h,00Eh,000h ; 182
      DB 000h,000h,002h,006h,002h,002h,007h,000h ; 183
      DB 000h,000h,006h,009h,002h,004h,00Fh,000h ; 184
      DB 000h,000h,00Fh,001h,002h,009h,006h,000h ; 185
      DB 000h,000h,00Ah,00Ah,00Fh,002h,002h,000h ; 186
      DB 000h,000h,00Eh,008h,00Eh,001h,00Eh,000h ; 187
      DB 000h,000h,006h,008h,00Eh,009h,006h,000h ; 188
      DB 000h,000h,00Fh,001h,002h,004h,004h,000h ; 189
      DB 000h,000h,006h,009h,006h,009h,006h,000h ; 190
      DB 000h,000h,006h,009h,007h,001h,006h,000h ; 191
      DB 000h,000h,012h,015h,01Dh,015h,012h,000h ; 192
      DB 000h,000h,00Ch,002h,00Eh,012h,00Dh,000h ; 193
      DB 001h,00Eh,010h,01Eh,011h,011h,00Eh,000h ; 194
      DB 000h,000h,012h,012h,012h,012h,00Fh,001h ; 195
      DB 00Eh,001h,001h,00Fh,011h,011h,00Eh,000h ; 196
      DB 000h,000h,00Eh,011h,01Fh,010h,00Eh,000h ; 197
      DB 000h,000h,00Eh,015h,015h,00Eh,004h,004h ; 198
      DB 000h,000h,00Ch,012h,004h,009h,006h,000h ; 199
      DB 000h,000h,011h,00Ah,004h,00Ah,011h,000h ; 200
      DB 000h,000h,012h,012h,012h,012h,00Dh,000h ; 201
      DB 00Ch,000h,012h,012h,012h,012h,00Dh,000h ; 202
      DB 000h,000h,011h,012h,01Ch,012h,011h,000h ; 203
      DB 000h,000h,007h,009h,009h,009h,011h,000h ; 204
      DB 000h,000h,011h,01Bh,015h,011h,011h,000h ; 205
      DB 000h,000h,011h,011h,01Fh,011h,011h,000h ; 206
      DB 000h,000h,00Eh,011h,011h,011h,00Eh,000h ; 207
      DB 000h,000h,01Fh,011h,011h,011h,011h,000h ; 208
      DB 000h,000h,00Fh,011h,00Fh,009h,011h,000h ; 209
      DB 000h,000h,01Eh,011h,011h,01Eh,010h,000h ; 210
      DB 000h,000h,00Eh,011h,010h,011h,00Eh,000h ; 211
      DB 000h,000h,01Fh,004h,004h,004h,004h,000h ; 212
      DB 000h,000h,011h,011h,00Fh,001h,001h,00Eh ; 213
      DB 000h,000h,015h,015h,00Eh,015h,015h,000h ; 214
      DB 00Ch,014h,018h,01Eh,011h,011h,00Eh,000h ; 215
      DB 000h,000h,010h,010h,01Eh,011h,01Eh,000h ; 216
      DB 000h,000h,011h,011h,01Dh,013h,01Dh,000h ; 217
      DB 000h,000h,00Eh,011h,006h,011h,00Eh,000h ; 218
      DB 000h,000h,011h,015h,015h,015h,01Fh,000h ; 219
      DB 000h,000h,01Eh,001h,007h,001h,01Eh,000h ; 220
      DB 000h,000h,015h,015h,015h,015h,01Fh,001h ; 221
      DB 000h,000h,011h,011h,00Fh,001h,001h,000h ; 222
      DB 000h,000h,018h,008h,00Eh,009h,00Eh,000h ; 223
      DB 012h,015h,015h,01Dh,015h,015h,012h,000h ; 224
      DB 00Eh,011h,011h,011h,01Fh,011h,011h,000h ; 225
      DB 01Fh,010h,010h,01Eh,011h,011h,01Eh,000h ; 226
      DB 012h,012h,012h,012h,012h,012h,01Fh,001h ; 227
      DB 006h,00Ah,00Ah,00Ah,00Ah,01Fh,011h,000h ; 228
      DB 01Fh,010h,010h,01Eh,010h,010h,01Fh,000h ; 229
      DB 004h,01Fh,015h,015h,01Fh,004h,004h,000h ; 230
      DB 01Fh,011h,010h,010h,010h,010h,010h,000h ; 231
      DB 011h,011h,00Ah,004h,00Ah,011h,011h,000h ; 232
      DB 011h,011h,013h,015h,019h,011h,011h,000h ; 233
      DB 015h,011h,013h,015h,019h,011h,011h,000h ; 234
      DB 011h,012h,014h,018h,014h,012h,011h,000h ; 235
      DB 007h,009h,009h,009h,009h,009h,019h,000h ; 236
      DB 011h,01Bh,015h,015h,011h,011h,011h,000h ; 237
      DB 011h,011h,011h,01Fh,011h,011h,011h,000h ; 238
      DB 00Eh,011h,011h,011h,011h,011h,00Eh,000h ; 239
      DB 01Fh,011h,011h,011h,011h,011h,011h,000h ; 240
      DB 00Fh,011h,011h,00Fh,005h,009h,011h,000h ; 241
      DB 01Eh,011h,011h,01Eh,010h,010h,010h,000h ; 242
      DB 00Eh,011h,010h,010h,010h,011h,00Eh,000h ; 243
      DB 01Fh,004h,004h,004h,004h,004h,004h,000h ; 244
      DB 011h,011h,011h,00Ah,004h,008h,010h,000h ; 245
      DB 011h,015h,015h,00Eh,015h,015h,011h,000h ; 246
      DB 01Eh,011h,011h,01Eh,011h,011h,01Eh,000h ; 247
      DB 010h,010h,010h,01Eh,011h,011h,01Eh,000h ; 248
      DB 011h,011h,011h,019h,015h,015h,019h,000h ; 249
      DB 00Eh,011h,001h,006h,001h,011h,00Eh,000h ; 250
      DB 011h,015h,015h,015h,015h,015h,01Fh,000h ; 251
      DB 00Eh,011h,001h,007h,001h,011h,00Eh,000h ; 252
      DB 015h,015h,015h,015h,015h,015h,01Fh,001h ; 253
      DB 011h,011h,011h,00Fh,001h,001h,001h,000h ; 254
      DB 000h,000h,000h,000h,000h,000h,000h,01Fh ; 255
fontEnd:

    ENDIF
