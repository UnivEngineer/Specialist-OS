;+---------------------------------------------------------------------------
; MXOS
; Загрузка программы с ленты. КС не загружается.
;
; В случае ошибки управление передается по адресу в bios_vars.tapeError
;
; На выходе 
;  bios_vars.tapeAddr - адрес загруженной программы
;
; 2013-12-12 Дизассемблировано vinxru
;----------------------------------------------------------------------------

tapeLoadInt:
            ; Ждем пилот-тон и читаем слово - это адрес загрузки программы
            ld      a, 0FFh
            call    tapeRead          
            ld      l, a
            ld      a, 8
            call    tapeRead
            ld      h, a
            ld      (bios_vars.tapeAddr), hl

            ; Читаем следующее слово - это конец программы
            ld      a, 8
            call    tapeRead
            ld      e, a
            ld      a, 8
            call    tapeRead
            ld      d, a

            ; Читаем тело программы
loc_C414:   ld      a, 8        
loc_C416:   call    tapeRead
            ld      (hl), a
            call    bios_cmp_hl_de
            inc     hl
            jp nz,  loc_C414

            ; Выходим не запуская
            ret

; ---------------------------------------------------------------------------
; Не используется

tapeLoadAny:
            ld    a, 0FFh
            jp    loc_C416

